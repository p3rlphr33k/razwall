import unittest
from endian.emi.menu.menu import Menu
from endian.emi.menu.cgi_menu import CGIMenu

class menuTests(unittest.TestCase):

    test_json = """{"04.services":{"caption":"Services","subMenu":{"10.qos":{"caption":"Quality of Service","subMenu":{"02.classes":{"caption":"Classes","title":"Quality of Service Classes","uri":"/manage/qos/classes","enabled":1},"03.rules":{"caption":"Rules","title":"Quality of Service Rules","uri":"/manage/qos/rules","enabled":1},"01.devices":{"caption":"Devices","title":"Quality of Service Devices","uri":"/manage/qos/devices","enabled":1}},"enabled":1},"05.ids":{"caption":"Intrusion Prevention","subMenu":{"01.configuration":{"caption":"Intrusion Prevention System","title":"Intrusion Prevention System","uri":"/cgi-bin/ids.cgi","helpuri":"efw.services.html#efw.services.ids","enabled":1},"02.rules":{"caption":"Rules","title":"Intrusion Prevention rules","uri":"/manage/ips/rules","enabled":1},"03.editor":{"caption":"Editor","title":"Intrusion Prevention editor","uri":"/manage/ips/editor","enabled":1}},"enabled":1},"06.ha":{"caption":"High availability","title":"High availability","enabled":1,"uri":"/cgi-bin/ha.cgi","helpuri":"efw.services.html#efw.services.ha"},"01.dhcp":{"caption":"DHCP server","title":"DHCP configuration","uri":"/cgi-bin/dhcp.cgi","enabled":1,"helpuri":"efw.services.html#efw.services.dhcp"},"02.dyndns":{"caption":"Dynamic DNS","title":"Dynamic DNS client","uri":"/cgi-bin/ddns.cgi","enabled":1,"helpuri":"efw.services.html#efw.services.ddns"},"03.time":{"caption":"Time server","title":"Time server","uri":"/cgi-bin/time.cgi","enabled":1,"helpuri":"efw.services.html#efw.services.ntp"},"06.ntop":{"caption":"Traffic Monitoring","title":"Network Traffic Analyzer","enabled":1,"uri":"/cgi-bin/ntop.cgi","helpuri":"efw.services.html#efw.services.ntop"},"04.spamassassin":{"caption":"Spam Training","title":"Spam Training","enabled":1,"uri":"/cgi-bin/salearn.cgi","helpuri":"efw.services.html#efw.services.spamtraining"},"03.avengine":{"caption":"Antivirus Engine","subMenu":{"01.settings":{"caption":"Settings","title":"Settings","uri":"/manage/avengine/settings","enabled":1,"helpuri":"efw.services.html#efw.services.avengine"},"03.sophos":{"caption":"Sophos AntiVirus","title":"Sophos AntiVirus","enabled":1,"uri":"/manage/avengine/sophos","helpuri":"efw.services.html#efw.services.sophos"},"02.clamav":{"caption":"Clamav AntiVirus","title":"Clamav AntiVirus","enabled":1,"uri":"/cgi-bin/clamav.cgi","helpuri":"efw.services.html#efw.services.clamav"}},"enabled":1},"09.snmp":{"caption":"SNMP Server","subMenu":{"01.snmp":{"caption":"SNMP Server","title":"SNMP Server","enabled":1,"uri":"/cgi-bin/snmp.cgi","helpuri":"#"}},"enabled":1}},"enabled":"on"},"02.status":{"caption":"Status","subMenu":{"01.systemstatus":{"caption":"System status","title":"System status information","uri":"/cgi-bin/status.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.system"},"02.networkstatus":{"caption":"Network status","title":"Network status information","uri":"/cgi-bin/netstatus.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.network"},"03.systemgraphs1":{"caption":"System graphs","vars":"graph=cpu","title":"System graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.system_graphs"},"04.trafficgraphs1":{"caption":"Traffic Graphs","vars":"graph=GREEN","title":"Network traffic graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.traffic_graphs"},"06.connections":{"caption":"Connections","title":"Connections","uri":"/cgi-bin/connections.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.connections"},"03.systemgraphs4":{"caption":"System graphs","vars":"graph=disk","title":"System graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.system_graphs"},"03.systemgraphs3":{"caption":"System graphs","vars":"graph=swap","title":"System graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.system_graphs"},"09.monit":{"caption":"Monit","title":"Monit","uri":"/cgi-bin/monit.cgi","enabled":0},"03.systemgraphs":{"novars":1,"caption":"System graphs","title":"System graphs","uri":"/cgi-bin/graphs.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.system_graphs"},"07.mailgraph":{"caption":"SMTP mail statistics","title":"SMTP mail statistics","uri":"/cgi-bin/mailgraph.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.mail_statistics"},"03.systemgraphs2":{"caption":"System graphs","vars":"graph=memory","title":"System graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.system_graphs"},"06.connections1":{"caption":"Connections","title":"Connections","uri":"/cgi-bin/ipinfo.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.connections"},
"06.openvpn":{"caption":"OpenVPN connections","title":"OpenVPN server connection status and control","enabled":1,"uri":"/cgi-bin/openvpn_connections.cgi","helpuri":"efw.status.html#efw.status.openvpn_connections"},"04.trafficgraphs2":{"caption":"Traffic Graphs","vars":"graph=BLUE","title":"Network traffic graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.traffic_graphs"},"08.mailqueue":{"caption":"Mail queue","title":"Mail queue","uri":"/cgi-bin/mailqueue.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.mail_queue"},"04.trafficgraphs":{"caption":"Traffic Graphs","vars":"graph=network","title":"Network traffic graphs","uri":"/cgi-bin/graphs.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.traffic_graphs"},"04.trafficgraphs3":{"caption":"Traffic Graphs","vars":"graph=ORANGE","title":"Network traffic graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.traffic_graphs"},"04.trafficgraphs4":{"caption":"Traffic Graphs","vars":"graph=RED_","title":"Network traffic graphs","uri":"/cgi-bin/graphs.cgi","enabled":0,"helpuri":"efw.status.html#efw.status.traffic_graphs"},"05.proxygraphs":{"caption":"Proxy graphs","title":"Proxy access graphs","uri":"/cgi-bin/proxygraphs.cgi","enabled":1,"helpuri":"efw.status.html#efw.status.proxy_graphs"}},"enabled":"on"},"07.vpn":{"caption":"VPN","subMenu":{"01.openvpnclient":{"caption":"OpenVPN client (Gw2Gw)","title":"OpenVPN - Virtual Private Networking","enabled":1,"uri":"/cgi-bin/openvpnclient.cgi","helpuri":"efw.vpn.html#efw.vpn.openvpn_client"},"00.openvpnserver":{"caption":"OpenVPN server","subMenu":{"04.download":{"caption":"VPN client download","title":"VPN client download","uri":"/cgi-bin/download-vpnclient.cgi","enabled":1,"helpuri":"efw.vpn.html#efw.vpn.openvpn_server"},"02.users":{"caption":"Accounts","title":"OpenVPN - Virtual Private Networking","uri":"/cgi-bin/openvpn_users.cgi","enabled":1,"helpuri":"efw.vpn.html#efw.vpn.openvpn_server"},"03.advanced":{"caption":"Advanced","title":"OpenVPN - Virtual Private Networking","uri":"/cgi-bin/openvpn_advanced.cgi","enabled":1,"helpuri":"efw.vpn.html#efw.vpn.openvpn_server"},"01.server":{"caption":"Server configuration","title":"OpenVPN - Virtual Private Networking","uri":"/cgi-bin/openvpn_server.cgi","enabled":1,"helpuri":"efw.vpn.html#efw.vpn.openvpn_server"}},"enabled":1},"03.ipsec":{"caption":"IPsec","title":"Virtual Private Networking","enabled":1,"uri":"/cgi-bin/vpnmain.cgi","helpuri":"efw.vpn.html#efw.vpn.ipsec"}},"enabled":"on"},"06.proxy":{"caption":"Proxy","subMenu":{"05.smtp":{"caption":"SMTP","subMenu":{"01.config":{"caption":"Configuration","title":"SMTP proxy: Configuration","uri":"/cgi-bin/smtpconfig.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"},"02.lists":{"caption":"Black- & Whitelists","title":"SMTP Black- & Whitelists","uri":"/cgi-bin/smtplists.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"},"06.advanced":{"caption":"Commtouch","title":"SMTP proxy: commtouch","uri":"/manage/commtouch/settings","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"},"03.domains":{"caption":"Incoming domains","title":"SMTP proxy: Incoming domains ","uri":"/cgi-bin/smtpdomains.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"},"04.routing":{"caption":"Mail routing","title":"SMTP proxy: blocked file extensions","uri":"/cgi-bin/smtprouting.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"},"05.advanced":{"caption":"Advanced","title":"SMTP proxy: advanced","uri":"/cgi-bin/smtpadvanced.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.smtp"}},"enabled":1},"04.ftp":{"caption":"FTP","subMenu":{"01.proxy":{"caption":"Proxies","title":"FTP: virus scanner","uri":"/cgi-bin/frox.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.ftp"}},"enabled":1},"06.dns":{"caption":"DNS","subMenu":{"01.proxy":{"caption":"DNS proxy","title":"DNS proxy","enabled":1,"uri":"/cgi-bin/dnsmasq.cgi","helpuri":"efw.proxy.html#efw.proxy.dns"},"03.blackhole":{"caption":"Anti-spyware","title":"Anti-spyware - blackhole DNS","enabled":1,"uri":"/cgi-bin/antispyware.cgi","helpuri":"efw.proxy.html#efw.proxy.dns"},"02.local":{"caption":"DNS Routing","title":"DNS Proxy - DNS Routing","enabled":1,"uri":"/cgi-bin/localdomains.cgi","helpuri":"efw.proxy.html#efw.proxy.dns"}},"enabled":1},"03.sip":{"caption":"SIP","subMenu":{"01.config":{"caption":"Settings","title":"SIP: proxy","uri":"/cgi-bin/siproxy.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.sip"},"02.advanced":{"caption":"advanced settings","title":"SIP: proxy","uri":"/cgi-bin/siproxy_adv.cgi","enabled":0,"helpuri":"efw.proxy.html#efw.proxy.sip"}},
"enabled":1},"01.http":{"caption":"HTTP","subMenu":{"01.config":{"caption":"Configuration","title":"HTTP proxy: Configuration","uri":"/cgi-bin/proxyconfig.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"},"03.authentication":{"caption":"Authentication","title":"HTTP proxy: Authentication","uri":"/cgi-bin/proxyauth.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"},"05.authentication":{"caption":"NCSA group","title":"HTTP proxy: Authentication","uri":"/cgi-bin/proxyuser.cgi","enabled":0,"helpuri":"efw.proxy.html#efw.proxy.http"},"08.adjoin":{"caption":"AD join","title":"HTTP proxy: AD join","uri":"/manage/proxy/adjoin","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"},"06.contentfilter":{"caption":"Contentfilter","title":"HTTP proxy: Contentfilter","uri":"/cgi-bin/dansguardian.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"},"02.policy":{"caption":"Access Policy","title":"HTTP proxy: Policy","uri":"/cgi-bin/proxypolicy.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"},"04.authentication":{"caption":"NCSA user","title":"HTTP proxy: Authentication","uri":"/cgi-bin/proxygroup.cgi","enabled":0,"helpuri":"efw.proxy.html#efw.proxy.http"},"07.virus":{"caption":"Antivirus","title":"HTTP proxy: Antivirus","uri":"/cgi-bin/httpantivirus.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.http"}},"enabled":1},"02.pop":{"caption":"POP3","subMenu":{"01.config":{"caption":"Global settings","title":"POP3: global settings","uri":"/cgi-bin/p3scan.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.pop3"},"02.spamfilter":{"caption":"Spam filter","title":"POP3: spam filter","uri":"/cgi-bin/spamassassin.cgi","enabled":1,"helpuri":"efw.proxy.html#efw.proxy.pop3"}},"enabled":1}},"enabled":"on"},"03.network":{"caption":"Network","subMenu":{"01.hosts":{"caption":"Edit hosts","title":"Host configuration","uri":"/cgi-bin/hosts.cgi","enabled":1,"helpuri":"efw.network.html#efw.network.hosts"},"06.routing":{"caption":"Routing","subMenu":{"02.policy":{"caption":"Policy Routing","title":"Policy Routing Editor","enabled":1,"uri":"/cgi-bin/policy_routing.cgi","helpuri":"efw.network.html#efw.network.routing"},"01.simple":{"caption":"Static Routing","title":"Static Routing Editor","enabled":1,"uri":"/cgi-bin/routing.cgi","helpuri":"efw.network.html#efw.network.routing"}},"enabled":1},"07.interfaces":{"caption":"Interfaces","subMenu":{"01.uplinkeditor":{"caption":"Uplink editor","title":"Uplinks manager","uri":"/cgi-bin/uplinkeditor.cgi","enabled":1,"helpuri":"efw.network.html#efw.network.interfaces"},"02.vlan":{"caption":"VLANs","title":"VLAN manager","uri":"/cgi-bin/vlanconfig.cgi","enabled":1,"helpuri":"efw.network.html#efw.network.interfaces"}},"enabled":1}},"enabled":"on"},"01.system":{"caption":"System","subMenu":{"07.gui":{"caption":"GUI settings","title":"GUI settings","uri":"/cgi-bin/gui.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.gui_settings"},"09.shutdown":{"caption":"Shutdown","title":"Shutdown/reboot","uri":"/cgi-bin/shutdown.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.shutdown"},"03.support":{"caption":"Support","title":"Endian support","enabled":1,"uri":"/cgi-bin/support.cgi","helpuri":"efw.system.html#efw.system.support"},"04.en":{"caption":"Endian Network","subMenu":{"02.enaccess":{"caption":"Remote Access","title":"Remote Access","uri":"/cgi-bin/enaccess.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.endian_network"},"01.register":{"caption":"Subscriptions","title":"Subscriptions","uri":"/cgi-bin/register.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.endian_network"}},"enabled":1},"01.home":{"caption":"Dashboard","title":"Dashboard","uri":"/cgi-bin/main.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.home"},"03.rbeforesupport_updates":{"caption":"Updates","title":"Updates","subMenu":{"01.updates":{"caption":"Updates","title":"Updates","uri":"/cgi-bin/updates.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.endian_network"}},"enabled":1},"02.netwizard":{"caption":"Network configuration","title":"Network configuration","uri":"/cgi-bin/netwizard.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.network_configuration"},"10.credits":{"caption":"Credits","title":"Credits","uri":"/cgi-bin/credits.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.credits"},"05.passwords":{"caption":"Passwords","title":"Passwords","uri":"/cgi-bin/changepw.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.passwords"},"06.ssh":{"caption":"SSH access","title":"SSH access","uri":"/cgi-bin/remote.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.ssh_access"},
"03.notifications":{"caption":"Event notifications","subMenu":{"01.settings":{"caption":"Settings","title":"Notification settings","uri":"/manage/notifications/settings","enabled":1},"02.events":{"caption":"Events","title":"Events","uri":"/manage/notifications/events","enabled":1}},"enabled":1},"08.backup":{"caption":"Backup","subMenu":{"02.scheduled":{"caption":"Scheduled backups","title":"Scheduled backups","uri":"/cgi-bin/backupschedule.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.backup"},"01.backup":{"caption":"Backup","title":"Backup","uri":"/cgi-bin/backup.cgi","enabled":1,"helpuri":"efw.system.html#efw.system.backup"}},"enabled":1}},"enabled":"on"},"08.logs":{"caption":"Logs","subMenu":{"00.livelogs":{"caption":"Live","title":"Live logs","uri":"/cgi-bin/logs_live_list.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.live"},"01.summary":{"caption":"Summary","title":"Log summary","uri":"/cgi-bin/logs_summary.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.summary"},"01.system":{"caption":"System","title":"System log viewer","uri":"/cgi-bin/logs_log.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.system"},"05.settings":{"caption":"Settings","title":"Log settings","uri":"/cgi-bin/logs_config.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.settings"},"02.service":{"caption":"Service","subMenu":{"01.ids":{"caption":"IDS","title":"Intrusion Detection System log viewer","uri":"/cgi-bin/logs_ids.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.service"},"02.openvpn":{"caption":"OpenVPN","title":"OpenVPN log","uri":"/cgi-bin/logs_openvpn.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.service"},"03.clamavlog":{"caption":"ClamAV","title":"ClamAV log","uri":"/cgi-bin/logs_clamav.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.service"}},"enabled":1},"04.proxy":{"caption":"Proxy","subMenu":{"04.smtplog":{"caption":"SMTP","title":"SMTP log viewer","uri":"/cgi-bin/logs_smtp.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.proxy"},"01.proxy":{"caption":"HTTP","title":"HTTP proxy log viewer","uri":"/cgi-bin/logs_proxy.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.proxy"},"03.sarg":{"caption":"HTTP report","title":"Proxy analysis report","enabled":1,"uri":"/cgi-bin/sarg.cgi","helpuri":"efw.logs.html#efw.logs.proxy"},"05.siproxd":{"caption":"SIP","title":"SIP log viewer","uri":"/cgi-bin/logs_siproxy.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.proxy"},"02.contentfilter":{"caption":"Content filter","title":"HTTP content filter","uri":"/cgi-bin/logs_dansguardian.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.proxy"}},"enabled":1},"03.firewall":{"caption":"Firewall","title":"Firewall log viewer","uri":"/cgi-bin/logs_firewall.cgi","enabled":1,"helpuri":"efw.logs.html#efw.logs.firewall"}},"enabled":1},"077.hotspot":{"caption":"Hotspot","subMenu":{"01.hotspotuser":{"caption":"Hotspot User","title":"Hotspot User","enabled":1,"uri":"/cgi-bin/hotspot-user.cgi","helpuri":"efw.hotspot.html"},"00.hotspot":{"caption":"Hotspot","title":"Hotspot","enabled":1,"uri":"/cgi-bin/hotspot.cgi","helpuri":"efw.hotspot.html"}},"enabled":"on"},"05.firewall":{"caption":"Firewall","subMenu":{"01.dnat":{"caption":"Port forwarding / NAT","subMenu":{"02.snat":{"caption":"Source NAT","title":"Source Network Address Translation","uri":"/cgi-bin/snat.cgi","enabled":1,"helpuri":"efw.firewall.html#efw.firewall.port_forwarding"},"01.dnat":{"caption":"Port forwarding / Destination NAT","title":"Port forwarding / Destination NAT","uri":"/cgi-bin/dnat.cgi","enabled":1,"helpuri":"efw.firewall.html#efw.firewall.port_forwarding"},"03.incoming":{"caption":"Incoming routed traffic","title":"Incoming firewall configuration","uri":"/cgi-bin/incoming.cgi","enabled":1,"helpuri":"efw.firewall.html#efw.firewall.incoming"}},"enabled":1},"05.xtaccess":{"caption":"System access","title":"System access configuration","enabled":1,"uri":"/cgi-bin/xtaccess.cgi","helpuri":"efw.firewall.html#efw.firewall.external_access"},"99.diagram":{"caption":"Firewall Diagrams","title":"Firewall Diagrams","uri":"/manage/firewall/diagram","enabled":1,"helpuri":"efw.firewall.html#efw.firewall"},"02.outgoing":{"caption":"Outgoing traffic","title":"Outgoing firewall configuration","enabled":1,"uri":"/cgi-bin/outgoingfw.cgi","helpuri":"efw.firewall.html#efw.firewall.outgoing_firewall"},"04.vpnfw":{"caption":"VPN traffic","title":"VPN firewall configuration","enabled":1,"uri":"/cgi-bin/vpnfw.cgi","helpuri":"efw.firewall.html#efw.firewall.vpn_traffic"},"03.zonefw":{"caption":"Inter-Zone traffic","title":"Inter-Zone firewall configuration","enabled":1,"uri":"/cgi-bin/zonefw.cgi",
"helpuri":"efw.firewall.html#efw.firewall.inter_zone_traffic"}},"enabled":"on"}}"""

    def setUp(self):
        Menu.force_menu_type = 'cgi'           
        Menu.default_uri = '/manage/qos/classes'
        self.menu = Menu(jsonmenu=self.test_json)
        
    def testData(self):
        self.menu.getData().has_key("01.system")
    
    def testPath(self): 
        menu = self.menu.getMenuForURI("/cgi-bin/backup.cgi")
        self.assertEqual(len(menu), 3)
        self.assertEqual(menu[2][0]["uri"], "/cgi-bin/backup.cgi")
    
    def testPathNoExist(self):
        self.assertEqual(self.menu.getPathForURI("/cgi-bin/suxxomatic.cgi"), [])
        self.assertEqual(self.menu.getMenuForURI("/cgi-bin/suxxomatic.cgi", default_if_null=False), []) 
        self.assertEqual(self.menu.getMenuForURI('xxx'), self.menu.getMenuForURI(self.menu.default_uri))
    
    def testMenuForURI(self):
        self.assertEqual(len(self.menu.getPathForURI("/cgi-bin/monit.cgi")), 2) 
        self.menu.getMenuForURI("/cgi-bin/monit.cgi")
    
    def testItemByURI(self):
        item = self.menu.getItemByURI("/cgi-bin/backup.cgi")
        self.assertEqual(item["caption"], "Backup")
    
    def testGetItemHelpURI(self):
        item = self.menu.getItemByURI("/cgi-bin/backup.cgi")
        self.menu.getItemHelpURI(item)
        
    def testMenuData(self):
        self.assertTrue(len(self.menu.menudata.keys()) > 0)
           
    def testDirtyMenu(self):
        CGIMenu.is_dirty = True
        self.menu.getItemByURI("/cgi-bin/backup.cgi")
        CGIMenu.is_dirty = True
        self.menu.getItemByURI("/cgi-bin/backup.cgi")
        
    def testNotExistingSubMenu(self):
        item1 = self.menu.getMenuForURI("/manage/notifications/settings")
        item2 = self.menu.getMenuForURI("/manage/notifications/settings/not-existing")
        self.assertEqual(item1, item2)
            
if __name__ == '__main__':
    unittest.main()
