#!/usr/bin/python
#
# +--------------------------------------------------------------------------+
# | Endian Firewall                                                          |
# +--------------------------------------------------------------------------+
# | Copyright (c) 2012-2013 Endian                                           |
# |         Endian GmbH/Srl                                                  |
# |         Bergweg 41 Via Monte                                             |
# |         39057 Eppan/Appiano                                              |
# |         ITALIEN/ITALIA                                                   |
# |         info@endian.com                                                  |
# |                                                                          |
# | efw-ipsec is free software: you can redistribute it and/or modify it     |
# | under the terms of GNU General Public License (GPL) version 2.0          |
# | when released with the Community edition                                 |
# | or the GNU Lesser General Public License (LGPL) version 2.1              |
# | when released with the Enterprise edition.                               |
# |                                                                          |
# | efw-ipsec is distributed in the hope that it will be useful,             |
# | but WITHOUT ANY WARRANTY; without even the implied warranty of           |
# | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the             |
# | GNU General Public License for more details or the                       |
# | GNU Lesser General Public License for more details.                      |
# |                                                                          |
# | You should have received a copy of the license along with efw-ipsec.     |
# | If not, see <http://www.gnu.org/licenses/>.                              |
# +--------------------------------------------------------------------------+

from endian.data import DataSource
from endian.validators.boolean import to_bool

__all__ = [
    "LOGGIN_TYPES",
    "is_ipsec_enabled",
    "get_debug_options",
]

LOGGIN_TYPES = ['dmn', 'mgr', 'ike', 'chd', 'job', 'cfg', 'knl', 'net', 'asn', 'enc', 'tls', 'lib', 'tnc', 'imc', 'imv', 'pts']

def is_ipsec_enabled():
    """ Return true if IPsec is enabled"""
    ds = DataSource()
    return to_bool(ds.vpn.settings.get('ENABLED', 'off'))

def get_debug_options():
    """ Get the enabled debug options """
    ds = DataSource()
    vpn_settings = ds.vpn.settings
    result = []
    for loggin_type in LOGGIN_TYPES:
        if to_bool(vpn_settings.get("DBG_%s" % loggin_type.upper() , 'off')):
            result.append("%s 4" % loggin_type)
    return ", ".join(result)


